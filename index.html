<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.1.2/axios.min.js"></script>
    <style>
#header{

    color: rgb(255, 0, 170);
    align-items: center;
    display: flex;
    margin-left: 40%;
}
#main1{
    align-items: center;
    display: flex;
    margin-left:40%;
}

body{
    background-image:url(./banner-img.webp );
    background-size: auto ; 
}


#refresh{
    align-items: center;
    display: flex;
    margin-left: 40%;
}
#add{
    align-items: center;
    display: flex;
    margin-left: 40%;
}










    </style>
</head>


<body>
    <div id="header"></header> <h1>TODO APP with server and Database</h1></div>


    <form onsubmit="postTodo(); return false">
      <div id="main1">  todo: <input id="todo" type="text" required> </div>
     <div id="add" ><button type="submit">Add</button> </div> 
   
    </form>
    <h5 id="message"></h5>
    <h3 id="result"> </h3>

 


</body>
<script>
const baseUrl = "https://upset-erin-shrimp.cyclic.app"

    function postTodo() {
        let todoText = document.querySelector("#todo").value

        axios.post(`${baseUrl}/todo`, {
            text: todoText
        })
            .then(function (response) {
                console.log(response.data);

              getAllTodos() ;  
                document.querySelector("#message").innerHTML =response.data.message
setTimeout(() => {
    document.querySelector("#message").innerHTML="";
},2000);


                // response.data.data.map(eachTodo => {
                    // document.querySelector("#result").innerHTML += eachTodo
                    // document.querySelector("#result").innerHTML += '<br>'
                // })

            })
            .catch(function (error) {
                console.log(error);
            })

    }

    function getAllTodos() {
        axios.get(`${baseUrl}/todos`)
            .then(function (response) {
                console.log(response.data);

                document.querySelector("#result").innerHTML = ""

                response.data.data.map(eachTodo => {
                    document.querySelector("#result").innerHTML += eachTodo.text
                    document.querySelector("#result").innerHTML += '<br>'
                })
            })
            .catch(function (error) {
                console.log(error);
            })
    }


getAllTodos();
    setInterval(() => {
        getAllTodos()
    }, 5000);

    </script>

    </html>